<div class="character-sheet p-6">
  <h2 class="text-2xl font-bold mb-6 text-gray-800">{{ 'character.creation.attributes.title' | dynamicTranslate }}</h2>
  <p class="text-gray-600 mb-6">{{ 'character.creation.attributes.description' | dynamicTranslate }}</p>

  <!-- Generation Method Selection -->
  <div class="mb-6">
    <h3 class="text-lg font-medium text-gray-800 mb-3">{{ 'character.creation.attributes.generationMethod' | dynamicTranslate }}</h3>
    <div class="flex space-x-4">
      <button 
        type="button"
        (click)="setGenerationMethod('quickfire')"
        [class]="generationMethod === 'quickfire' ? 'px-4 py-2 bg-blue-600 text-white rounded-md' : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300'"
        class="transition-colors">
        {{ 'character.creation.attributes.quickFireMethod' | dynamicTranslate }}
      </button>
      <button 
        type="button"
        (click)="setGenerationMethod('rolling')"
        [class]="generationMethod === 'rolling' ? 'px-4 py-2 bg-blue-600 text-white rounded-md' : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300'"
        class="transition-colors">
        {{ 'character.creation.attributes.rollingMethod' | dynamicTranslate }}
      </button>
    </div>
  </div>

  <!-- Occupation-related characteristics with chips -->
  <div *ngIf="characterSheet.occupation && getOccupationCharacteristicsChips().length > 0" 
       class="bg-yellow-50 p-4 rounded-md border border-yellow-200 mb-6">
    <h4 class="font-medium text-yellow-900 mb-3">
      {{ 'character.creation.attributes.occupationReminder' | dynamicTranslate }}
    </h4>
    <p class="text-sm text-yellow-800 mb-3">
      {{ 'character.creation.attributes.occupationExplanation' | dynamicTranslate }}
    </p>
    <div class="flex flex-wrap gap-2">
      <span *ngFor="let chip of getOccupationCharacteristicsChips()" 
            class="px-3 py-1 rounded-full text-sm font-medium"
            [class.bg-blue-100]="chip.type === 'fixed'"
            [class.text-blue-800]="chip.type === 'fixed'"
            [class.bg-orange-100]="chip.type === 'choice'"
            [class.text-orange-800]="chip.type === 'choice'">
        {{ chip.label }}
      </span>
    </div>
  </div>

  <!-- Auto-assign button -->
  <div *ngIf="characterSheet.occupation" class="mb-6">
    <button 
      type="button"
      (click)="autoAssignCharacteristics()"
      [disabled]="!canAutoAssign()"
      class="px-6 py-3 rounded-md font-medium transition-all duration-200 shadow-sm"
      [class.bg-green-600]="canAutoAssign()"
      [class.text-white]="canAutoAssign()"
      [class.hover:bg-green-700]="canAutoAssign()"
      [class.transform]="canAutoAssign()"
      [class.hover:scale-105]="canAutoAssign()"
      [class.bg-gray-300]="!canAutoAssign()"
      [class.text-gray-500]="!canAutoAssign()"
      [class.cursor-not-allowed]="!canAutoAssign()">
      <i class="fas fa-magic mr-2"></i>
      {{ 'character.creation.attributes.autoAssign' | dynamicTranslate }}
    </button>
    <p class="text-sm text-gray-600 mt-2">
      {{ 'character.creation.attributes.autoAssignDescription' | dynamicTranslate }}
    </p>
  </div>

  <!-- Quick Fire Method -->
  <div *ngIf="generationMethod === 'quickfire'" class="space-y-6">
    <div class="bg-blue-50 p-4 rounded-md border border-blue-200">
      <h4 class="font-medium text-blue-900 mb-2">{{ 'character.creation.attributes.quickFireMethodTitle' | dynamicTranslate }}</h4>
      <p class="text-sm text-blue-700 mb-3">{{ 'character.creation.attributes.quickFireDescription' | dynamicTranslate }}</p>
      
      <!-- Available values -->
      <div class="mb-4">
        <p class="text-sm font-medium text-blue-800 mb-2">{{ 'character.creation.attributes.availableValues' | dynamicTranslate }}:</p>
        <div class="flex flex-wrap gap-2">
          <span *ngFor="let value of quickFireValues; let i = index" 
                class="cursor-pointer px-3 py-1 rounded-full text-sm font-medium transition-all duration-200"
                [class.bg-blue-100]="selectedQuickFireIndex !== i"
                [class.text-blue-800]="selectedQuickFireIndex !== i"
                [class.bg-blue-600]="selectedQuickFireIndex === i"
                [class.text-white]="selectedQuickFireIndex === i"
                [class.ring-2]="selectedQuickFireIndex === i"
                [class.ring-blue-400]="selectedQuickFireIndex === i"
                (click)="selectQuickFireValue(i)">
            {{ value }}
          </span>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <div *ngFor="let char of characteristics; let i = index" class="characteristic-item transition-all duration-200" 
           [class.important]="isCharacteristicImportant(char.key)"
           [class.cursor-pointer]="canAssignQuickFireValue(char.key) && selectedQuickFireIndex !== null"
           [class.assignable-characteristic]="canAssignQuickFireValue(char.key) && selectedQuickFireIndex !== null"
           (click)="assignSelectedQuickFireValue(char.key)">
        
        <div class="characteristic-card bg-white border-2 border-gray-300 rounded-lg p-4 text-center relative"
             [class.border-yellow-400]="isCharacteristicImportant(char.key)">
          <h4 class="text-sm font-medium mb-2 text-gray-700">
            {{ 'character.attributes.' + char.key | dynamicTranslate }}
            <span *ngIf="isCharacteristicImportant(char.key)" class="text-yellow-600 ml-1">★</span>
          </h4>
          
          <div class="mb-2">
            <span class="text-3xl font-bold text-gray-900">
              {{ getCharacteristicDisplayValue(char.key) }}
            </span>
          </div>
          
          <button *ngIf="isCharacteristicAssigned(char.key)" 
                  (click)="returnQuickFireValue(char.key); $event.stopPropagation()"
                  class="absolute top-2 right-2 text-red-500 hover:text-red-700 text-lg hover:bg-red-50 rounded p-1 transition-colors">
            ↶
          </button>
          
          <div class="text-sm text-gray-600 mb-3">
            <div>Moitié : {{ getHalfCharacteristicValue(char.key) }}</div>
            <div>5ème : {{ getFifthCharacteristicValue(char.key) }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Rolling Method -->
  <div *ngIf="generationMethod === 'rolling'" class="space-y-6">
    <div class="bg-green-50 p-4 rounded-md border border-green-200">
      <h4 class="font-medium text-green-900 mb-2">{{ 'character.creation.attributes.rollingMethodTitle' | dynamicTranslate }}</h4>
      <p class="text-sm text-green-700 mb-3">{{ 'character.creation.attributes.rollingDescription' | dynamicTranslate }}</p>
    </div>

    <!-- Wide Range Characteristics (Pool A: 3d6×5) -->
    <div class="space-y-4">
      <div class="bg-red-50 p-4 rounded-md border border-red-200">
        <h5 class="font-medium text-red-900 mb-2">{{ 'character.creation.attributes.wideRangeCharacteristics' | dynamicTranslate }}</h5>
        <div class="mb-3">
          <p class="text-sm font-medium text-red-800 mb-2">{{ 'character.creation.attributes.availableRolls' | dynamicTranslate }}: 3d6×5</p>
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let value of rollingPoolA; let i = index" 
                  class="cursor-pointer px-3 py-1 rounded-full text-sm font-medium transition-all duration-200"
                  [class.bg-red-100]="selectedRollIndex !== i || selectedRollPool !== 'A'"
                  [class.text-red-800]="selectedRollIndex !== i || selectedRollPool !== 'A'"
                  [class.bg-red-600]="selectedRollIndex === i && selectedRollPool === 'A'"
                  [class.text-white]="selectedRollIndex === i && selectedRollPool === 'A'"
                  [class.ring-2]="selectedRollIndex === i && selectedRollPool === 'A'"
                  [class.ring-red-400]="selectedRollIndex === i && selectedRollPool === 'A'"
                  (click)="selectRoll('A', i)">
              {{ value }}
            </span>
          </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div *ngFor="let char of getPoolACharacteristics(); let i = index" class="characteristic-item transition-all duration-200"
               [class.important]="isCharacteristicImportant(char.key)"
               [class.cursor-pointer]="canAssignToCharacteristic(char.key) && selectedRollIndex !== null"
               [class.assignable-characteristic]="canAssignToCharacteristic(char.key) && selectedRollIndex !== null"
               (click)="assignSelectedRollToCharacteristic(char.key)">
            
            <div class="characteristic-card bg-white border-2 border-gray-300 rounded-lg p-4 text-center relative"
                 [class.border-yellow-400]="isCharacteristicImportant(char.key)">
              <h4 class="text-sm font-medium mb-2 text-gray-700">
                {{ 'character.attributes.' + char.key | dynamicTranslate }}
                <span *ngIf="isCharacteristicImportant(char.key)" class="text-yellow-600 ml-1">★</span>
              </h4>
              
              <div class="mb-2 h-16 flex items-center justify-center">
                <input *ngIf="isCharacteristicAssigned(char.key)"
                       type="number"
                       [value]="getCharacteristicDisplayValue(char.key)"
                       (change)="onCharacteristicInputChange($event, char.key)"
                       min="15" max="90" step="5"
                       class="w-20 h-12 text-3xl font-bold px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-red-500 text-center bg-white"
                       (click)="$event.stopPropagation()">
                <span *ngIf="!isCharacteristicAssigned(char.key)"
                      class="text-3xl font-bold text-gray-500 h-12 flex items-center justify-center">
                  -
                </span>
              </div>
              
              <button *ngIf="isCharacteristicAssigned(char.key)" 
                      (click)="returnCharacteristicValue(char.key); $event.stopPropagation()"
                      class="absolute top-2 right-2 text-red-500 hover:text-red-700 text-lg hover:bg-red-50 rounded p-1 transition-colors">
                ↶
              </button>
              
              <div class="text-sm text-gray-600 mb-3">
                <div>Moitié : {{ getHalfCharacteristicValue(char.key) }}</div>
                <div>5ème : {{ getFifthCharacteristicValue(char.key) }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Higher Range Characteristics (Pool B: (2d6+6)×5) -->
    <div class="space-y-4">
      <div class="bg-purple-50 p-4 rounded-md border border-purple-200">
        <h5 class="font-medium text-purple-900 mb-2">{{ 'character.creation.attributes.higherRangeCharacteristics' | dynamicTranslate }}</h5>
        <div class="mb-3">
          <p class="text-sm font-medium text-purple-800 mb-2">{{ 'character.creation.attributes.availableRolls' | dynamicTranslate }}: (2d6+6)×5</p>
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let value of rollingPoolB; let i = index"
                  class="cursor-pointer px-3 py-1 rounded-full text-sm font-medium transition-all duration-200"
                  [class.bg-purple-100]="selectedRollIndex !== i || selectedRollPool !== 'B'"
                  [class.text-purple-800]="selectedRollIndex !== i || selectedRollPool !== 'B'"
                  [class.bg-purple-600]="selectedRollIndex === i && selectedRollPool === 'B'"
                  [class.text-white]="selectedRollIndex === i && selectedRollPool === 'B'"
                  [class.ring-2]="selectedRollIndex === i && selectedRollPool === 'B'"
                  [class.ring-purple-400]="selectedRollIndex === i && selectedRollPool === 'B'"
                  (click)="selectRoll('B', i)">
              {{ value }}
            </span>
          </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div *ngFor="let char of getPoolBCharacteristics(); let i = index" class="characteristic-item transition-all duration-200"
               [class.important]="isCharacteristicImportant(char.key)"
               [class.cursor-pointer]="canAssignToCharacteristic(char.key) && selectedRollIndex !== null"
               [class.assignable-characteristic]="canAssignToCharacteristic(char.key) && selectedRollIndex !== null"
               (click)="assignSelectedRollToCharacteristic(char.key)">
            
            <div class="characteristic-card bg-white border-2 border-gray-300 rounded-lg p-4 text-center relative"
                 [class.border-yellow-400]="isCharacteristicImportant(char.key)">
              <h4 class="text-sm font-medium mb-2 text-gray-700">
                {{ 'character.attributes.' + char.key | dynamicTranslate }}
                <span *ngIf="isCharacteristicImportant(char.key)" class="text-yellow-600 ml-1">★</span>
              </h4>
              
              <div class="mb-2 h-16 flex items-center justify-center">
                <input *ngIf="isCharacteristicAssigned(char.key)"
                       type="number"
                       [value]="getCharacteristicDisplayValue(char.key)"
                       (change)="onCharacteristicInputChange($event, char.key)"
                       min="40" max="90" step="5"
                       class="w-20 h-12 text-3xl font-bold px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-purple-500 text-center bg-white"
                       (click)="$event.stopPropagation()">
                <span *ngIf="!isCharacteristicAssigned(char.key)"
                      class="text-3xl font-bold text-gray-500 h-12 flex items-center justify-center">
                  -
                </span>
              </div>
              
              <button *ngIf="isCharacteristicAssigned(char.key)" 
                      (click)="returnCharacteristicValue(char.key); $event.stopPropagation()"
                      class="absolute top-2 right-2 text-red-500 hover:text-red-700 text-lg hover:bg-red-50 rounded p-1 transition-colors">
                ↶
              </button>
              
              <div class="text-sm text-gray-600 mb-3">
                <div>Moitié : {{ getHalfCharacteristicValue(char.key) }}</div>
                <div>5ème : {{ getFifthCharacteristicValue(char.key) }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>