<div *ngIf="isOpen" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
     (click)="onBackdropClick()">
  <div class="character-sheet m-4 p-6 {{ maxWidth }} max-h-[90vh] overflow-y-auto"
       (click)="stopPropagation($event)">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-300">
      <h3 class="gothic-header text-2xl">{{ title }}</h3>
      <button (click)="onClose()" 
              class="text-3xl text-gray-600 hover:text-gray-800 leading-none transition-colors">
        Ã—
      </button>
    </div>

    <!-- Content -->
    <div class="modal-content">
      <ng-container *ngIf="contentTemplate" [ngTemplateOutlet]="contentTemplate"></ng-container>
      <ng-content></ng-content>
    </div>

    <!-- Footer buttons based on type -->
    <div class="mt-6 flex gap-3 justify-center">
      <!-- Dialog mode: no buttons (only X in header) -->
      
      <!-- Form mode: Save and Cancel -->
      <ng-container *ngIf="type === 'form'">
        <button (click)="onSave()" 
                class="flex-1 sm:flex-none px-6 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors">
          {{ 'ui.actions.save' | dynamicTranslate }}
        </button>
        <button (click)="onClose()" 
                class="flex-1 sm:flex-none px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">
          {{ 'ui.actions.cancel' | dynamicTranslate }}
        </button>
      </ng-container>

      <!-- Confirm mode: OK and Cancel -->
      <ng-container *ngIf="type === 'confirm'">
        <!-- Destructive action (delete) -->
        <button *ngIf="isDestructive"
                (click)="onConfirmOk()" 
                [disabled]="disableConfirm"
                [class.opacity-50]="disableConfirm"
                [class.cursor-not-allowed]="disableConfirm"
                class="flex-1 sm:flex-none px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:hover:bg-red-600">
          {{ 'ui.actions.delete' | dynamicTranslate }}
        </button>
        <!-- Normal action (OK) -->
        <button *ngIf="!isDestructive"
                (click)="onConfirmOk()" 
                [disabled]="disableConfirm"
                [class.opacity-50]="disableConfirm"
                [class.cursor-not-allowed]="disableConfirm"
                class="flex-1 sm:flex-none px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors disabled:hover:bg-blue-500">
          {{ 'ui.actions.ok' | dynamicTranslate }}
        </button>
        <button (click)="onConfirmCancel()" 
                class="flex-1 sm:flex-none px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">
          {{ 'ui.actions.cancel' | dynamicTranslate }}
        </button>
      </ng-container>
    </div>
  </div>
</div>
