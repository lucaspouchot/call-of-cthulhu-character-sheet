<!-- Skill Selector Component -->
<div class="border-2 border-purple-300 rounded-lg p-4 bg-purple-50">
  <h4 *ngIf="title" class="text-md font-semibold mb-3 text-purple-800">{{ title | dynamicTranslate }}</h4>
  <h4 *ngIf="!title" class="text-md font-semibold mb-3 text-purple-800">{{ 'character.sheet.addSkill' | dynamicTranslate }}</h4>
  
  <!-- Skill Type Selection (only if not forced and both types allowed) -->
  <div *ngIf="shouldShowTypeSelector()" class="mb-3">
    <label class="block text-sm font-medium text-gray-700 mb-2">
      {{ 'character.sheet.skillType' | dynamicTranslate }}
    </label>
    <div class="flex gap-2">
      <button
        *ngIf="allowCustomSkill"
        type="button"
        (click)="newSkillType = 'custom'"
        [class]="newSkillType === 'custom' 
          ? 'flex-1 px-3 py-2 bg-indigo-500 text-white border border-indigo-600 rounded-lg text-sm'
          : 'flex-1 px-3 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm'"
      >
        {{ 'character.sheet.customSkill' | dynamicTranslate }}
      </button>
      <button
        *ngIf="allowSpecializedSkill"
        type="button"
        (click)="newSkillType = 'specialized'"
        [class]="newSkillType === 'specialized'
          ? 'flex-1 px-3 py-2 bg-purple-500 text-white border border-purple-600 rounded-lg text-sm'
          : 'flex-1 px-3 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm'"
      >
        {{ 'character.sheet.specializedSkill' | dynamicTranslate }}
      </button>
    </div>
  </div>

  <!-- Custom Skill Form -->
  <div *ngIf="newSkillType === 'custom' && allowCustomSkill" class="space-y-3">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'character.sheet.skillName' | dynamicTranslate }}
      </label>
      <input
        type="text"
        [value]="newSkillName"
        (input)="newSkillName = $any($event.target).value"
        [placeholder]="'character.sheet.skillNamePlaceholder' | dynamicTranslate"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"
      />
    </div>
  </div>

  <!-- Specialized Skill Form -->
  <div *ngIf="newSkillType === 'specialized' && allowSpecializedSkill" class="space-y-3">
    <!-- Base Skill Selection (only if not forced) -->
    <div *ngIf="!forcedBaseSkill">
      <label class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'character.sheet.baseSkill' | dynamicTranslate }}
      </label>
      <select
        [value]="selectedBaseSkill"
        (change)="selectedBaseSkill = $any($event.target).value; selectedSpecialization = ''; customSpecializationName = ''"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm"
      >
        <option value="">{{ 'character.sheet.selectBaseSkill' | dynamicTranslate }}</option>
        <option *ngFor="let skillDef of specializableSkills" [value]="skillDef.id">
          {{ 'skills.' + skillDef.id | dynamicTranslate }}
        </option>
      </select>
    </div>
    <div *ngIf="forcedBaseSkill" class="text text-gray-700">
      {{ 'skills.' + forcedBaseSkill | dynamicTranslate }}
    </div>

    <!-- Predefined Specialization Selection -->
    <div *ngIf="(selectedBaseSkill || forcedBaseSkill) && canUsePredef()">
      <label class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'character.sheet.predefinedSpecialization' | dynamicTranslate }}
      </label>
      <select
        [value]="selectedSpecialization"
        (change)="selectedSpecialization = $any($event.target).value; customSpecializationName = ''"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm"
      >
        <option value="">{{ 'character.sheet.orCustom' | dynamicTranslate }}</option>
        <option *ngFor="let spec of getAvailableSpecializations()" [value]="spec.id">
          {{ 'skills.' + spec.id | dynamicTranslate }} ({{ spec.baseValue }}%)
        </option>
      </select>
    </div>

    <!-- Custom Specialization Name Input -->
    <div *ngIf="(selectedBaseSkill || forcedBaseSkill) && !selectedSpecialization">
      <label class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'character.sheet.customSpecializationName' | dynamicTranslate }}
      </label>
      <input
        type="text"
        [value]="customSpecializationName"
        (input)="customSpecializationName = $any($event.target).value"
        [placeholder]="'character.sheet.customSpecializationPlaceholder' | dynamicTranslate"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm"
      />
    </div>
  </div>

  <!-- Initial Points Input (only shown when enabled) -->
  <div *ngIf="showInitialPoints" class="mt-3 pt-3 border-t border-purple-200">
    <label class="block text-sm font-medium text-gray-700 mb-1">
      {{ 'character.sheet.initialPoints' | dynamicTranslate }}
    </label>
    <input
      type="number"
      [value]="newSkillInitialPoints"
      (input)="newSkillInitialPoints = +$any($event.target).value"
      min="0"
      max="99"
      [placeholder]="'character.sheet.initialPointsPlaceholder' | dynamicTranslate"
      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
    />
    <p class="text-xs text-gray-500 mt-1">
      {{ 'character.sheet.initialPointsHint' | dynamicTranslate }}
    </p>
  </div>

  <!-- Add Button -->
  <div class="mt-4">
    <button
      type="button"
      (click)="addNewSkill()"
      [disabled]="isAddButtonDisabled()"
      class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-sm font-medium"
    >
      {{ 'ui.actions.add' | dynamicTranslate }}
    </button>
  </div>
</div>
